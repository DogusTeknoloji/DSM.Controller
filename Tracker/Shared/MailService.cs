using DSM.Core.Models;
using System;
using System.Collections.Generic;
using System.Net;
using System.Net.Mail;
using System.Net.Security;
using System.Security.Cryptography.X509Certificates;
using System.Text;

namespace DSM.Controller.Tracker.Shared
{
    public partial class MailService
    {
        private const string mail_user = "";
        private const string mail_password = "";

        public const string BASE64_WARNING = "data:image/png;base64,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";
        public const string BASE64_CRITICAL_CASE = "data:image/png;base64,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////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AFP3ByUAAAIeSURBVHja1Jc/SAMxFMa/O4oU/yyiIOggtSAuUicHJ0UcHJxPtCCC4CKCi5Ob3URRBDuJ4JLFQQWRLh64OUkRQSkiOokgJ4gW0Z5D7bWXe8nl0kHMctfkvV+/95J7SQwX9TUTfw2IyYczPbDkFoY0BwwA5Agz3B9D9eZgQRfAAi/RAPGi1/QAe4SWKABW879FHUCRTIc6wO9SXI0M4FQnoy5ldsv3WJEUZPJ8Tz5aCJ1hSQkBBAMQSqAB+fB5kQI80x3HcRyPuqYMqAgYmAQAj/CiCvAEnJUfjiwIoiKtPPP0UqUjq6TgWfwJMRVA1SgeGLNVADZUipQYwKTl0R4MBdjyAjsQBqAEHMoMuGlcPyWKQMFnkpMqOA3fJZgMwBRqyK4shDFQhcwfAhJZoQJ6Coe533c9QgW8gLKCQgCZEyjYUz1UMFqBFfzeEyapoFZCTVlvbAwYfsYBdBESLCIEprbD8ApM0QqT76qzQYBAwLwA0R9I4mXE412KA5y3k2ZbwHQrOXJp+QCjWdJqHQCWaAlJH+CGNtoEACySY6W+mnXw8CULVzDY8FkFXMv8Jx7p/qNqCKxX5Fw4w5yQvHpQAZxontTHfwF2sybgagaIAd3bb5qAtrKCY/3bRtMIYtQWqNy+AROpUh3NgeHeF+q4MSW7Y3Bb9P2XL94NF/sfuv6vHWkYLp5y2grSvyuxbUPLfcoMvfb9i6vv3wN+BgDiosjkzc/bdAAAAABJRU5ErkJggg==";

        public const string TITLE_COLOR_RED = "rgb(211,35,44)";
        public const string TITLE_COLOR_YELLOW = "rgb(197,178,23)";

        /// <summary>
        ///  Sends alert mail to specified recipients with passed content
        /// </summary>
        /// <param name="recipients">All Recipients</param>
        /// <param name="mailContent">Content of Mail </param>
        /// <param name="htmlContent">Is Content type HTML?</param>
        public static void SendMail(IEnumerable<IISAlertMailRecipient> recipients, string mailContent, bool htmlContent = true)
        {
            SmtpClient mailClient = new SmtpClient
            {
                Port = 25,
                DeliveryMethod = SmtpDeliveryMethod.Network,
                Host = "",
                EnableSsl = false
            };

            NetworkCredential mailCredentials = new NetworkCredential(mail_user, mail_password);
            mailClient.Credentials = mailCredentials;

            MailAddress senderAddress = new MailAddress("", "DSM Services", Encoding.UTF8);

            MailMessage mail = new MailMessage
            {
                Subject = "Tracker Service Alert | DSM by Doguş Technology",
                From = senderAddress,
                IsBodyHtml = htmlContent,
                Body = mailContent
            };

            foreach (IISAlertMailRecipient recipient in recipients)
            {
                MailAddress address = new MailAddress(recipient.MailAddress, recipient.DisplayName);
                if (recipient.IsDirectRecipient)
                {
                    mail.To.Add(address);
                }
                else if (recipient.IsCCRecipient)
                {
                    mail.CC.Add(address);
                }

                else if (recipient.IsBCCRecipient)
                {
                    mail.Bcc.Add(address);
                }
            }

            mailClient.Send(mail);
        }
    }
}
